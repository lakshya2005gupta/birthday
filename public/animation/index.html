<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Birthday Animation â€” Ayush</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="stylesheet.css" />
  <link rel="stylesheet" href="loading.css" />
  <link rel="stylesheet" href="cake.less" />
  <style>
    /* Ensure animation container fills the iframe cleanly and buttons at bottom center */
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      font-family: 'Signika', sans-serif;
    }
    .wrap {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .control-panel {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 32px;
      z-index: 999;
      display:flex;
      gap: 12px;
      align-items:center;
      justify-content:center;
      pointer-events:auto;
    }

    .control-panel .btn {
      padding: 10px 18px;
      border-radius: 8px;
      background-color:#3b6fb0;
      color:#fff;
      border: 0;
      cursor: pointer;
      font-weight:700;
      box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    }

    /* a small frame for the original design area, maintain the balloon/cake layout */
    .stage {
      width: 100%;
      height: 100%;
      position: relative;
    }

    /* make balloon-name appear centered in balloon */
    .balloons { display:block; position:absolute; width:100px; height:180px; background-size:100px 180px; }
    .balloon-name { position:absolute; top:52%; left:50%; transform:translate(-50%,-50%); font-weight:700; color:#8a2b2b; pointer-events:none; }

    /* hide page scrollbar inside iframe */
    ::-webkit-scrollbar { display:none; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stage">
      <!-- keep existing HTML structure used by the Ayush scripts:
           images with ids b1..b7, balloon-border etc. -->
      <!-- Balloon border / frame -->
      <img src="Balloon-Border.png" class="balloon-border" alt="" />

      <!-- example balloon elements (place exactly as the original project expects them) -->
      <div id="b1" class="balloons" style="left:10%; top:10%;"></div>
      <div id="b2" class="balloons" style="left:22%; top:10%;"></div>
      <div id="b3" class="balloons" style="left:34%; top:10%;"></div>
      <div id="b4" class="balloons" style="left:46%; top:10%;"></div>
      <div id="b5" class="balloons" style="left:58%; top:10%;"></div>
      <div id="b6" class="balloons" style="left:70%; top:10%;"></div>
      <div id="b7" class="balloons" style="left:82%; top:10%;"></div>

      <!-- overlay name DIV which will be centered inside each balloon via CSS + JS -->
      <div class="balloon-name" id="balloon-central-name" aria-hidden="true">I</div>

      <!-- cake and other elements (keep the original HTML if you have them) -->
      <div class="cake"></div>

    </div>

    <!-- control panel - bottom centre inside iframe -->
    <div class="control-panel" role="group" aria-label="Animation controls">
      <button id="turn_on" class="btn">Turn on lights</button>
      <button id="play" class="btn">Play music</button>
      <button id="bannar_coming" class="btn">Bring the cake</button>
      <button id="balloons_flying" class="btn">Fly with balloons</button>
      <button id="cake_fadein" class="btn">Show cake</button>
      <button id="light_candle" class="btn">Light candle</button>
      <button id="wish_message" class="btn">Show the wish</button>
    </div>
  </div>

  <!-- audio (animation-specific) -->
  <audio class="song" src="bgm-animations.mp3" preload="auto"></audio>

  <!-- include jQuery first (required by effect.js) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- original animation scripts from Ayush -->
  <script src="effect.js"></script>

  <script>
    // Make sure effects.js buttons are wired exactly like original project.
    // When the final "wish_message" step is done, send a message to parent
    // so the React app can advance to the "main" stage.
    (function () {
      const wishBtn = document.getElementById('wish_message');
      if (wishBtn) {
        wishBtn.addEventListener('click', function () {
          // Wait a bit so the animation completes visually, then post to parent
          setTimeout(() => {
            try {
              parent.postMessage({ type: 'animation-done' }, '*');
            } catch (e) {
              // ignore
            }
          }, 900); // small delay to let final transitions finish
        });
      }

      // Fix: center single-letter per balloon behavior.
      // If you want separate letters in different balloons, effect.js should create them.
      // But to center the existing overlay text inside each balloon element, do:
      function centerBalloonNames() {
        const names = document.querySelectorAll('.balloons');
        names.forEach((el) => {
          // create a small centered span per balloon if missing
          if (!el.querySelector('.balloon-inner-name')) {
            const s = document.createElement('div');
            s.className = 'balloon-inner-name';
            s.style.position = 'absolute';
            s.style.top = '52%';
            s.style.left = '50%';
            s.style.transform = 'translate(-50%, -50%)';
            s.style.pointerEvents = 'none';
            s.style.fontWeight = '700';
            s.style.color = '#8a2b2b';
            s.innerText = el.dataset.letter || 'I';
            el.appendChild(s);
          }
        });
      }
      // run after DOM load
      document.addEventListener('DOMContentLoaded', centerBalloonNames);
    })();
  </script>
</body>
</html>
